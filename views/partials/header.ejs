<header>
	<nav class="navbar navbar-expand-lg navbar-dark ftco_navbar bg-dark ftco-navbar-light" id="ftco-navbar">
	    <div class="container">
	      <div class="logo-container">
          <img src="/assets/images/FUEL_AID_logo_nobg.png" alt="Logo">
          <a class="navbar-brand" href="/">Fuel<span>Aid</span></a>
        </div>
	      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#ftco-nav" aria-controls="ftco-nav" aria-expanded="false" aria-label="Toggle navigation">
	        <span class="oi oi-menu"></span> Menu
	      </button>

	      <div class="collapse navbar-collapse" id="ftco-nav">
	        <ul class="navbar-nav ml-auto">
			  <% if(!currentUser) { %>
	          <li class="nav-item active"><a href="/" class="nav-link">Home</a></li>
	          <li class="nav-item"><a href="#about" class="nav-link">About Us</a></li>
	          <li class="nav-item"><a href="#services" class="nav-link">Our Services</a></li>
			  <li class="nav-item"><a href="#blog" class="nav-link">Blogs</a></li>
	          <li class="nav-item"><a href="#footer" class="nav-link">Contact</a></li>
				<li class="nav-item"><a href="/auth/login" class="nav-link">Login/Signup</a></li>
			  <% } else { %>
				<li class="nav-item"><a href="/auth/logout" class="nav-link">Logout</a></li>
				<li class="user-avatar-container">
					<img id="headerProfilePic" 
						 src="<%= currentUser.role === 'admin' ? '/assets/images/admin.svg' : (currentUser.profilePic || 'data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 200 200%22%3E%3Ccircle cx=%22100%22 cy=%22100%22 r=%22100%22 fill=%22%23888%22/%3E%3Ctext x=%2250%25%22 y=%2250%25%22 dominant-baseline=%22middle%22 text-anchor=%22middle%22 font-size=%2270%22 fill=%22%23fff%22%3E%3F%3C/text%3E%3C/svg%3E') %>" 
						 alt="<%= currentUser.firstName %>" 
						 class="user-avatar-img"
						 title="<%= currentUser.firstName %> <%= currentUser.lastName %>">
				</li>
			  <% } %>
	        </ul>
	      </div>
	    </div>
	  </nav>
</header>

<style>
	.user-avatar-container {
		margin-left: 15px;
		display: flex;
		align-items: center;
	}

	.user-avatar-img {
		width: 45px;
		height: 45px;
		border-radius: 50%;
		object-fit: cover;
		border: 2px solid rgba(255, 255, 255, 0.3);
		transition: all 0.3s ease;
		cursor: pointer;
	}

	.user-avatar-img:hover {
		border-color: rgba(255, 255, 255, 0.7);
		box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
		transform: scale(1.05);
	}
</style>

<script>
	// Update header profile picture when page loads
	window.addEventListener('load', function() {
		const headerImg = document.getElementById('headerProfilePic');
		if (headerImg) {
			// Check if there's a newly uploaded preview
			const storedPreview = localStorage.getItem('profilePhotoPreview');
			if (storedPreview) {
				headerImg.src = storedPreview;
			}
		}
	});

	// Listen for profile updates
	document.addEventListener('profileUpdated', function(e) {
		const headerImg = document.getElementById('headerProfilePic');
		if (headerImg && e.detail && e.detail.profilePic) {
			headerImg.src = e.detail.profilePic;
		}
	});
</script>